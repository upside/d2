#!/usr/bin/env bash
set -euo pipefail

check() {
  local label="$1"; shift
  if "$@" >/dev/null 2>&1; then
    echo "[ok] $label"
  else
    echo "[missing] $label"
  fi
}

check "docker" docker --version
check "docker compose" docker compose version
check "php" php -v
check "composer" composer --version
check "node" node --version
check "npm" npm --version

echo
if command -v lsof >/dev/null 2>&1; then
  for p in 8080 5173 5432; do
    if lsof -iTCP:"$p" -sTCP:LISTEN -nP >/dev/null 2>&1; then
      echo "[warn] port $p is already in use"
    else
      echo "[ok] port $p free"
    fi
  done
else
  echo "(tip) install lsof to check ports"
fi
